{% extends 'base.html' %}
{% load static %}


{% block content %}

  {% load apptags %}




  <section>
    <div class="container-fluid mt-4">
      
      <div class="row">


        <div class="col-lg-1">
            <!-- Форма фильтров -->
            <div class="dropdown mb-2">
              <button class="btn btn-secondary dropdown-toggle btn-dark" type="button" data-bs-toggle="dropdown"
                  aria-expanded="false">
                  Фильтры
              </button>

              <form action="{% if request.GET.q %}{% url "search" %}{% else %}{% url 'prices' supplier_slug category_slug %}{% endif %}" method="get" class="dropdown-menu bg-dark" data-bs-theme="dark">
                  <div class="form-check text-white mx-3">
                      <input class="form-check-input" type="checkbox" name="on_sale" id="flexCheckDefault" value="on" {% if request.GET.on_sale == 'on' %}checked{% endif %}>
                      {% if request.GET.q %}
                          <input type="hidden" name="q" value="{{ request.GET.q }}">
                      {% endif %}
                      <label class="form-check-label" for="flexCheckDefault">
                          Товары по акции
                      </label>
                  </div>
                  <p class="text-white mx-3 mt-3">Сортировать:</p>
                  <div class="form-check text-white mx-3">
                      <input class="form-check-input" type="radio" name="order_by" id="flexRadioDefault1" value="default"
                      {% if not request.GET.order_by or request.GET.order_by == 'default' %}checked{% endif %}>
                      <label class="form-check-label" for="flexRadioDefault1">
                          По умолчанию
                      </label>
                  </div>
                  <div class="form-check text-white mx-3">
                      <input class="form-check-input" type="radio" name="order_by" id="flexRadioDefault2" value="price" 
                      {% if request.GET.order_by == 'price' %}checked{% endif %}>
                      <label class="form-check-label" for="flexRadioDefault2">
                          От дешевых к дорогим
                      </label>
                  </div>
                  <div class="form-check text-white mx-3">
                      <input class="form-check-input" type="radio" name="order_by" id="flexRadioDefault3" value="-price"
                      {% if request.GET.order_by == '-price' %}checked{% endif %}>
                      <label class="form-check-label" for="flexRadioDefault3">
                          От дорогих к дешевым
                      </label>
                  </div>
                  <button type="submit" class="btn btn-primary mx-3 mt-3">Применить</button>
              </form>
            </div>            
        </div>








        <div class="col-lg-8 col-md-12">
          {% if request.GET.q %}
            <h3 class="mt-4">Результаты поиска по запросу {{ request.GET.q }}</h3>
          {% if not all_goods_db %}
            <h2 class="mt-4">По запросу ничего не найдено</h2>
          {% endif %}
          {% endif %}
          <div class="row">

            {% include 'pract/includes/all_goods.html' %}

          </div>
        </div>

        <div class="col-lg-3 col-md-12">
          <div class="row px-2">
            



            {% show_categories supplier_slug category_slug sup_db cat_db %}

          </div>
        </div>



      </div>
    </div>


    {% if page_obj.has_other_pages %}
    <nav class="list-pages">
        <ul>

          {% if page_obj.has_previous %}
            <li class="page-num">
              {% comment %} <a href="?page={{ page_obj.previous_page_number }}">&#9650;</a> {% endcomment %}
              <a href="?{% change_params page=page_obj.previous_page_number %}">&#9650;</a>
            </li>
          {% endif %}

          {% for p in paginator.page_range %}
            {% if page_obj.number == p %}
              <li class="page-num page-num-selected">{{ p }}</li>
            {% elif p >= page_obj.number|add:-2 and p <= page_obj.number|add:2 %}
              <li class="page-num">
                  {% comment %} <a href="?page={{ p }}">{{ p }}</a> {% endcomment %}
                  <a href="?{% change_params page=p %}">{{ p }}</a>
              </li>
            {% endif %}
          {% endfor %}

          {% if page_obj.has_next %}
            <li class="page-num">
              {% comment %} <a href="?page={{ page_obj.next_page_number }}">&#9660;</a> {% endcomment %}
              <a href="?{% change_params page=page_obj.next_page_number %}">&#9660;</a>
            </li>
          {% endif %}

        </ul>
    </nav>
    {% endif %}


  </section>
{% endblock %}


{% block footer %}
  <footer class="mt-4">
    <div class="container-fluid">
      <div class="row">

        <div class="col-lg-4 col-md-12 footer-txt text-center">
          <P>All Rights Reserved 2025</P>
        </div>


        <div class="col-lg-4 col-md-12 footer-txt text-center">

          <div class="row px-0">
            <nav class="nav flex-column">

              <a class="nav-link" href="{% url 'about' %}">О нас</a>

              {% if perms.pract.add_goods %}
                <a class="nav-link" href="{% url 'AddGoodsView' %}">Добавить продукцию</a>
              {% endif %}

              <a class="nav-link disabled" aria-disabled="true">Contacts</a>
              <a class="nav-link disabled" aria-disabled="true">Job</a>
            </nav>
          </div>


        </div>


        <div class="col-lg-4 col-md-12 medialinks">
          <img style="width: 40px; margin-inline: 1em;"
            src="{% static 'pract/files/instagram-vector-social-media-icon-7-june-2021-bangkok-thailand/instagram.svg' %}"
            alt="insta">
          <img style="width: 40px; margin-inline: 1em;"
            src="{% static 'pract/files/instagram-vector-social-media-icon-7-june-2021-bangkok-thailand/telegram-svgrepo-com.svg' %}"
            alt="telega">
        </div>
      </div>

    </div>
  </footer>

{% endblock footer %}